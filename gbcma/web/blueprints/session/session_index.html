{% extends "general.html" %}

{% block body %}
{% import "session_view.html" as v %}

<script src="/static/session_controller.js"></script>
<script src="/static/session_user_controller.js"></script>

{{ v.view() }}

<script id="session-key" type="text">
{{session._id}}
</script>

<script id="stage-template" type="text/x-handlebars-template">
{% raw %}
    {{# if proposal }}
        <div id="proposal-content" class="panel panel-default">
            <div class="panel-heading">Current proposal ({{progress.current}}/{{progress.total}})</div>
            <div class="panel-body">
                <h1>
                    {{ proposal.title }}
                </h1>
                <p>{{ proposal.content }}</p>
            </div>

        </div>

        <div class="panel panel-default">
            <div class="panel-heading">Straw vote</div>
            <div class="panel-body">
                <a href="#" class="btn btn-success vote" data-vote="true">
                    <span class="glyphicon glyphicon-thumbs-up" aria-hidden="true"></span> Yes
                </a>
                <a href="#" class="btn btn-danger vote" data-vote="false">
                    <span class="glyphicon glyphicon-thumbs-down" aria-hidden="true"></span> No
                </a>
                <a href="#" class="btn btn-warning vote" data-vote="null">
                    <span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span> Abstained
                </a>
            </div>
        </div>

        <div class="panel panel-default">
            <div class="panel-heading">Comments</div>
            <div class="panel-body">
                {{#each comments}}

                <div class="media">
                    <div class="media-left media-top">
                        <span class="glyphicon {{thumbsIcon type}}" aria-hidden="true"></span>
                    </div>

                    <div class="media-body">
                        <h4 class="media-heading">{{user}}</h4>
                        {{#if quote}}<blockquote>{{quote}}</blockquote>{{/if}}
                        {{content}}
                    </div>
                </div>

                {{else}}
                    No comments yet
                {{/each}}
            </div>
        </div>

        <div class="panel panel-default">
            <div class="panel-heading">Add comment</div>
            <div class="panel-body">
                <blockquote id="quotation" hidden="hidden"></blockquote>
                <textarea id="comment-message" class="form-control" placeholder="Write down your PMI here"></textarea>
                <div class="btn-group btn-group-sm btn-group-justified" role="group">
                    <a role="button" class="comment-add btn btn-success" data-type="plus">Plus</a>
                    <a role="button" class="comment-add btn btn-danger" data-type="minus">Minus</a>
                    <a role="button" class="comment-add btn btn-info" data-type="info">Info</a>
                </div>
            </div>
        </div>

    {{/if}}

    {{# if closed }}
        <div class="panel panel-default">
            <div class="panel-heading">Session is about to end</div>
            <div class="panel-body">
                <h1>All proposals have been reviewed.</h1>
            </div>
        </div>
    {{/if}}
{% endraw %}
</script>
{% endblock %}

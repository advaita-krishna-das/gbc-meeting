{% macro view() %}
<script id="stage-template" type="text/x-handlebars-template">
    {% raw %}

    {{# if proposal }}
    <div class="panel panel-default">
        <div class="panel-heading">Current proposal (Stage: {{progress.index}}/{{progress.total}})</div>
        <div class="panel-body {{#if (ne stage.type 'acquaintance')}}proposal-block{{/if}}" id="proposal-content">
            <h1>{{ proposal.title }}</h1>
            <p>{{{ proposal.content }}}</p>
        </div>
    </div>
    {{/if}}

    {{> (stageType) }}
    {% endraw %}
</script>


{% for stage in ['acquaintance', 'agenda', 'closed', 'commenting', 'discussion', 'voting', 'voting_results'] %}
    <script id="stage-{{stage}}" type="text/x-handlebars-template">
        {% include "views/session_stage_" + stage + ".html" %}
    </script>
{% endfor %}

<script id="session-users-line" type="text/x-handlebars-template">
    {%raw%}
    <li>
        {{name}} <small>{{role}}</small> {{user}}
        {{#ifHas @user.permissions "session.manage"}}
        <a href='#'>
            <span class='glyphicon glyphicon-remove kick' data-user-id='{{id}}'></span>
        </a>
        {{/ifHas}}
    </li>
    {%endraw%}
</script>

{% endmacro %}